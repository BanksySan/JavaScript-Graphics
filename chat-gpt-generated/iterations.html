<!DOCTYPE html>
<html>
<head>
  <style>
      #mandelbrotSVG {
          border: 1px solid black;
      }
  </style>
</head>
<body>
<svg height="800" id="mandelbrotSVG" width="800"></svg>
<script>
  const svg = document.getElementById("mandelbrotSVG");
  const width = svg.clientWidth;
  const height = svg.clientHeight;
  let xIterations = 1000;

  function mandelbrot(c_re, c_im, maxIter) {
    let z_re = c_re;
    let z_im = c_im;

    const points = [{
      x: c_re,
      y: c_im
    }];

    for (let n = 0; n < maxIter; n++) {
      const z_re2 = z_re * z_re;
      const z_im2 = z_im * z_im;

      if (z_re2 + z_im2 > 4) {
        break;
      }

      const z_re_temp = z_re2 - z_im2 + c_re;
      z_im = 2 * z_re * z_im + c_im;
      z_re = z_re_temp;

      points.push({
        x: z_re,
        y: z_im
      });
    }

    return points;
  }

  function plotMandelbrot(c_re, c_im, maxIter) {
    svg.innerHTML = "";
    const points = mandelbrot(c_re, c_im, maxIter);
    const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
    let d = `M ${points[0].x * 100 + width / 2} ${points[0].y * 100 + height / 2}`;

    for (let i = 1; i < points.length; i++) {
      d += ` L ${points[i].x * 100 + width / 2} ${points[i].y * 100 + height / 2}`;
    }

    path.setAttribute("d", d);
    path.setAttribute("stroke", "black");
    path.setAttribute("fill", "none");

    svg.appendChild(path);
  }

  svg.addEventListener("mousemove", (event) => {
    const c_re = (event.clientX / width) * 3 - 2;
    const c_im = (event.clientY / height) * 3 - 1.5;

    plotMandelbrot(c_re, c_im, xIterations);
  });
</script>
</body>
</html>
